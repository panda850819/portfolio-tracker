# Portfolio Tracker 需求文件

## 1. 系統概述
一個整合性的投資組合追蹤系統，用於追蹤和管理多種資產類別，包括台股、美股、加密貨幣（交易所和錢包）以及現金資產。

## 1.1 介面設計補充需求
- 採用現代化卡片式分組設計，資訊分層明確，參考 CoinStats、Percento 等專業資產管理工具。
- 總資產區塊需以大字體、明顯卡片方式置頂，重要數字加粗、顏色強化。
- 各資產類型/幣種以圓角卡片顯示，帶有彩色標籤或圖標，並依資產類型自動變色：
  - 總資產卡片：綠色邊框
  - 股票資產卡片：藍色邊框
  - 加密貨幣卡片：紫色邊框
  - 現金資產卡片：黃色邊框
- 每個資產卡片包含：
  - 資產名稱
  - 資產圖標
  - 當前價值
  - 月度漲跌幅（帶有上升/下降箭頭及顏色區分）
- 資產分佈圖表和資產成長圖表以視覺化方式呈現資產配置和趨勢
- 行動裝置友善（RWD），單欄排列，資訊簡潔，重要資訊優先顯示
- 支援深色模式與亮色模式
- 卡片內資訊分層明確，數字加粗，重要資訊顏色強化
- 刪除、編輯等操作按鈕以懸浮圖標方式顯示於卡片右上角
- 支援 hover 陰影、分隔線、動畫等細節，提升互動體驗
- 預留圖標、漲跌箭頭、分隔線等視覺細節

## 2. 資產類別

### 2.1 台股
- 來源：國泰證券
- 更新頻率：即時
- 數據輸入：手動輸入

### 2.2 美股
- 來源：國泰證券
- 更新頻率：即時
- 數據輸入：手動輸入
- 特殊考慮：匯率影響

### 2.3 加密貨幣
#### 2.3.1 交易所資產
支援的交易所：
- Flipser
- OKX
- Binance
- Gateio
- Bybit
- Ourbit

特點：
- 支援多帳戶管理
- 即時更新
- 手動輸入

#### 2.3.2 錢包資產
支援的區塊鏈：
- Bitcoin (BTC)
- Ethereum (ETH)
- Solana (SOL)
- Sui (SUI)
- 其他 EVM 相容鏈
- 其他主流公鏈

特點：
- 多錢包地址管理
- 跨鏈資產追蹤
- 區分不同鏈上的同種代幣（如 USDT）

#### 2.3.3 DeFi 協議資產
功能：
- 質押資產追蹤
- LP 資產追蹤
- 借貸資產追蹤
- APY 監控
- 健康因子追蹤

### 2.4 現金
- 手動記錄
- 多幣種支援

## 3. 核心功能

### 3.1 資產追蹤
- 即時資產價值更新
- 多維度資產分類
- 跨平台資產整合
- 歷史數據追蹤

### 3.2 分析功能
- 資產配置比例分析
- 收益率計算
- 歷史表現追蹤
- 風險評估

### 3.3 DeFi 監控
- APY 異常變動提醒
- 借貸健康度監控
- 清算風險評估

### 3.4 交易歷史
- 交易記錄查詢
- 交易類型分析
- Gas 費用統計

## 4. User Stories

### 4.1 資產管理
1. 作為投資者，我希望能夠手動輸入台股和美股持倉，以便追蹤我的股票投資，並在一個美觀、現代化、卡片式的介面中清楚呈現。
2. 作為加密貨幣投資者，我希望能夠管理多個交易所的多個帳戶，以便全面追蹤我的交易所資產，並在分層、色彩分明的卡片介面中瀏覽。
3. 作為錢包使用者，我希望能夠追蹤不同區塊鏈上的多個錢包地址，以便管理我的鏈上資產，並在行動裝置友善的卡片式介面中查看。
4. 作為 DeFi 使用者，我希望能夠追蹤我在不同協議中的資產，包括質押、LP 和借貸倉位，並在分組卡片中一目了然。

### 4.2 監控與警報 (非優先處理)
1. 作為 DeFi 投資者，我希望在 APY 發生異常變動時收到通知，以便及時調整策略。
   - **Given** 我在網頁應用中，並且已經登錄到我的帳戶。
   - **When** APY 發生異常變動（超過設定的閾值）。
   - **Then** 系統應該能夠發送通知給我，告知 APY 的變動情況。

2. 作為借貸使用者，我希望能夠監控我的借貸健康因子，並在接近清算閾值時收到警告。
   - **Given** 我在網頁應用中，並且已經登錄到我的帳戶。
   - **When** 借貸健康因子接近清算閾值。
   - **Then** 系統應該能夠發送警告通知給我，提醒我注意風險。

### 4.3 分析與報告
1. 作為投資者，我希望能夠查看我的總體投資收益率，以便評估投資表現。
2. 作為投資者，我希望能夠查看不同資產類別的歷史表現，以便進行投資決策。
3. 作為投資者，我希望能夠查看詳細的交易歷史，以便進行交易分析。

## 5. Acceptance Criteria

### 5.1 資產管理
- **User Story**: 作為投資者，我希望能夠手動輸入台股和美股持倉，以便追蹤我的股票投資，並在一個美觀、現代化、卡片式的介面中清楚呈現。
  - **Given** 我在網頁應用中，並且已經登錄到我的帳戶。
  - **When** 我手動輸入台股或美股的持倉資訊（如股票代碼、持股數量、購買價格）。
  - **Then** 系統應該能夠以卡片式、分層、色彩分明的現代化介面顯示我輸入的持倉資訊，並更新我的資產總值。

- **User Story**: 作為加密貨幣投資者，我希望能夠管理多個交易所的多個帳戶，以便全面追蹤我的交易所資產，並在分層、色彩分明的卡片介面中瀏覽。
  - **Given** 我在網頁應用中，並且已經登錄到我的帳戶。
  - **When** 我添加多個交易所帳戶並輸入相應的資產資訊。
  - **Then** 系統應該能夠以分組卡片式介面顯示所有交易所的資產總值和各自的詳細資訊。

- **User Story**: 作為錢包使用者，我希望能夠追蹤不同區塊鏈上的多個錢包地址，以便管理我的鏈上資產，並在行動裝置友善的卡片式介面中查看。
  - **Given** 我在網頁應用中，並且已經登錄到我的帳戶。
  - **When** 我添加多個錢包地址並輸入相應的資產資訊。
  - **Then** 系統應該能夠以卡片式、RWD 友善的介面顯示所有錢包的資產總值和各自的詳細資訊。

- **User Story**: 作為 DeFi 使用者，我希望能夠追蹤我在不同協議中的資產，包括質押、LP 和借貸倉位，並在分組卡片中一目了然。
  - **Given** 我在網頁應用中，並且已經登錄到我的帳戶。
  - **When** 我添加 DeFi 協議的資產資訊。
  - **Then** 系統應該能夠以分組卡片式介面顯示所有 DeFi 資產的總值和各自的詳細資訊。

### 5.2 監控與警報 (非優先處理)
- **User Story**: 作為 DeFi 投資者，我希望在 APY 發生異常變動時收到通知，以便及時調整策略。
  - **Given** 我在網頁應用中，並且已經登錄到我的帳戶。
  - **When** APY 發生異常變動（超過設定的閾值）。
  - **Then** 系統應該能夠發送通知給我，告知 APY 的變動情況。

- **User Story**: 作為借貸使用者，我希望能夠監控我的借貸健康因子，並在接近清算閾值時收到警告。
  - **Given** 我在網頁應用中，並且已經登錄到我的帳戶。
  - **When** 借貸健康因子接近清算閾值。
  - **Then** 系統應該能夠發送警告通知給我，提醒我注意風險。

### 5.3 分析與報告
- **User Story**: 作為投資者，我希望能夠查看我的總體投資收益率，以便評估投資表現。
  - **Given** 我在網頁應用中，並且已經登錄到我的帳戶。
  - **When** 我查看我的投資收益率。
  - **Then** 系統應該能夠顯示我的總體投資收益率和各資產類別的收益率。

- **User Story**: 作為投資者，我希望能夠查看不同資產類別的歷史表現，以便進行投資決策。
  - **Given** 我在網頁應用中，並且已經登錄到我的帳戶。
  - **When** 我查看不同資產類別的歷史表現。
  - **Then** 系統應該能夠顯示各資產類別的歷史表現圖表。

- **User Story**: 作為投資者，我希望能夠查看詳細的交易歷史，以便進行交易分析。
  - **Given** 我在網頁應用中，並且已經登錄到我的帳戶。
  - **When** 我查看我的交易歷史。
  - **Then** 系統應該能夠顯示所有交易的詳細資訊，包括交易類型、金額和時間。

## 6. 技術需求

### 6.1 數據更新
- 即時市場數據更新
- 定期鏈上數據同步
- 手動數據輸入介面

### 6.2 安全性
- 安全的數據存儲
- 私鑰保護
- 訪問權限控制

### 6.3 可擴展性
- 支援新增資產類別
- 支援新增交易所
- 支援新增區塊鏈

## 7. 非功能需求

### 7.1 性能
- 即時數據更新
- 快速響應時間
- 高效數據處理

### 7.2 可用性
- 直觀的使用者介面，採用現代化卡片式設計，資訊分層明確，色彩分明，數字強調。
- 清晰的數據展示，重要資訊加粗、顏色強化。
- 便捷的操作流程，支援行動裝置友善（RWD）、深色模式、動畫互動效果。

### 7.3 可靠性
- 數據準確性
- 系統穩定性
- 錯誤處理機制

## 8. Google Apps Script 後端需求

### 8.1 Google Sheets 數據存儲
- 資產表（Assets）需包含：
  - 資產基本信息（ID、名稱、類型）
  - 持倉信息（數量、成本）
  - 當前市場價格
  - 最後更新時間戳
  - 備註欄位

- 交易記錄表（Transactions）需包含：
  - 交易ID
  - 關聯資產ID
  - 交易類型（買入/賣出）
  - 交易數量和價格
  - 交易時間
  - 交易備註

- 設置表（Settings）需包含：
  - 預設貨幣設置
  - 價格更新頻率設置
  - 顯示選項設置

### 8.2 API 功能需求
- 資產管理：
  - 獲取所有資產列表
  - 添加新資產
  - 更新現有資產
  - 刪除資產
  - 批量更新資產價格

- 交易管理：
  - 記錄新交易
  - 查詢歷史交易
  - 按資產篩選交易
  - 按時間範圍篩選交易

- 數據同步：
  - 定時自動更新資產價格
  - 提供手動更新價格的接口
  - 數據變更時自動計算相關數值

### 8.3 安全需求
- API 訪問控制：
  - 實現基於 OAuth 的認證
  - 限制只有授權用戶可以訪問
  - 區分讀寫權限

- 數據保護：
  - 敏感數據加密存儲
  - 操作日誌記錄
  - 數據備份機制

### 8.4 性能需求
- 響應時間：
  - API 響應時間不超過 2 秒
  - 批量操作響應時間不超過 5 秒

- 並發處理：
  - 支持多用戶同時訪問
  - 避免數據競爭條件
  - 實現數據鎖定機制

### 8.5 可維護性需求
- 代碼組織：
  - 模塊化設計
  - 清晰的命名規範
  - 完整的註釋文檔

- 錯誤處理：
  - 詳細的錯誤日誌
  - 友好的錯誤提示
  - 異常恢復機制

### 8.6 擴展性需求
- 支持添加新的資產類型
- 支持自定義數據欄位
- 支持擴展 API 功能
- 預留外部系統集成接口
